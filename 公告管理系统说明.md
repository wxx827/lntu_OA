# 公告管理系统使用说明

## 数据库初始化

请在MySQL中执行以下SQL语句创建公告表:

```sql
CREATE TABLE IF NOT EXISTS OA_ANNOUNCEMENT (
    id BIGINT AUTO_INCREMENT PRIMARY KEY COMMENT '公告ID',
    title VARCHAR(200) NOT NULL COMMENT '公告标题',
    content TEXT NOT NULL COMMENT '公告内容',
    type VARCHAR(20) DEFAULT 'normal' COMMENT '公告类型: important-重要, urgent-紧急, normal-普通',
    status TINYINT DEFAULT 1 COMMENT '状态: 0-草稿, 1-已发布, 2-已撤回',
    publisher_id VARCHAR(32) NOT NULL COMMENT '发布人ID',
    publisher_name VARCHAR(50) COMMENT '发布人姓名',
    publish_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '发布时间',
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    views INT DEFAULT 0 COMMENT '浏览次数',
    is_top TINYINT DEFAULT 0 COMMENT '是否置顶: 0-否, 1-是',
    INDEX idx_publisher (publisher_id),
    INDEX idx_status (status),
    INDEX idx_type (type),
    INDEX idx_publish_time (publish_time)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='公告表';

-- 初始化示例数据
INSERT INTO OA_ANNOUNCEMENT (title, content, type, status, publisher_id, publisher_name, is_top) VALUES
('欢迎使用OA协同办公系统', '尊敬的各位同事,欢迎使用全新升级的OA协同办公系统。本系统集成了考勤、审批、会议、物资等多项功能,旨在提升办公效率。如有任何问题,请联系IT部门。', 'important', 1, 'E001', 'Admin', 1),
('系统维护通知', '定于本周六晚上22:00-24:00进行系统维护升级,届时系统将暂停服务,请各位提前做好工作安排。给您带来不便,敬请谅解。', 'urgent', 1, 'E001', 'Admin', 0),
('节假日安排通知', '根据国家法定节假日安排,春节假期为1月28日至2月3日,共7天。请各部门合理安排工作,做好值班安排。', 'normal', 1, 'E001', 'Admin', 0);
```

## 功能说明

### 1. 公告管理 (管理员)
- **路径**: 系统设置 > 公告管理
- **功能**:
  - 发布新公告
  - 编辑已有公告
  - 删除公告
  - 置顶/取消置顶
  - 查看公告详情和浏览量

### 2. 公告展示 (所有用户)
- **位置**: Dashboard 工作台右侧"公告通知"卡片
- **特性**:
  - 自动显示最新5条已发布公告
  - 置顶公告优先显示
  - 点击可查看详情
  - 自动统计浏览次数

### 3. 公告类型
- **普通**: 日常通知
- **重要**: 重要事项,红色标签
- **紧急**: 紧急通知,橙色标签

## API接口

### 后端接口
- `GET /api/announcement/list` - 获取所有已发布公告
- `GET /api/announcement/latest?limit=5` - 获取最新N条公告
- `GET /api/announcement/{id}` - 获取公告详情(自动增加浏览量)
- `POST /api/announcement/save` - 创建/更新公告
- `DELETE /api/announcement/{id}` - 删除公告
- `PUT /api/announcement/withdraw/{id}` - 撤回公告
- `PUT /api/announcement/toggle-top/{id}` - 切换置顶状态

## 数据库表结构

### OA_ANNOUNCEMENT
| 字段 | 类型 | 说明 |
|------|------|------|
| id | BIGINT | 主键,自增 |
| title | VARCHAR(200) | 公告标题 |
| content | TEXT | 公告内容 |
| type | VARCHAR(20) | 类型: normal/important/urgent |
| status | TINYINT | 状态: 0-草稿, 1-已发布, 2-已撤回 |
| publisher_id | VARCHAR(32) | 发布人ID |
| publisher_name | VARCHAR(50) | 发布人姓名 |
| publish_time | DATETIME | 发布时间 |
| create_time | DATETIME | 创建时间 |
| update_time | DATETIME | 更新时间 |
| views | INT | 浏览次数 |
| is_top | TINYINT | 是否置顶: 0-否, 1-是 |

## 使用流程

1. **管理员发布公告**:
   - 登录系统
   - 进入"系统设置 > 公告管理"
   - 点击"发布公告"
   - 填写标题、内容、选择类型
   - 可选择是否置顶
   - 点击"发布"

2. **员工查看公告**:
   - 登录后在Dashboard右侧自动显示最新公告
   - 点击公告标题查看详情
   - 系统自动记录浏览次数

3. **管理公告**:
   - 编辑: 修改公告内容
   - 置顶: 重要公告可置顶显示
   - 撤回: 已发布的公告可撤回
   - 删除: 永久删除公告

## 注意事项

1. 公告内容支持最多2000字
2. 置顶公告会优先显示在列表顶部
3. 删除操作不可恢复,请谨慎操作
4. 浏览次数在用户查看详情时自动增加
